function $(/* args */) {
    let root = document;
    let query = arguments[0];
    if (arguments[0] instanceof Element || arguments[0] instanceof DocumentFragment) {
        root = arguments[0];
        query = arguments[1];
    }
    return root.querySelector(query);
}

function svg(type) {
    return document.createElementNS('http://www.w3.org/2000/svg', type);
}

// Utility

// Draws the animation panel attached to the given app view
function drawAnimations(animations, app) {
    const animationsView = app.querySelector("#animations");
    const keyframeView = app.querySelector("#keyframe");

    animationsView.innerHTML = "";
    for (let animation of animations) {
        const li = document.createElement('li');
        drawAnimation(li, animation);
        animationsView.appendChild(li);
    }

    // Drawing animation keyframes
    function drawAnimation(parentElement, animation) {
        // copy template for foo.
        let elem = $('#animation_template').content.cloneNode(true);
        // $(elem,'.timing').innerHTML=`<div class="timings">${JSON.stringify(animation.effect.getTiming())}</div>`
        const keyframesViewSVG = $(elem, '.keyframes svg');

        const keyframes = animation.effect.getKeyframes();
        for (let i = 0; i < keyframes.length; i++) {
            const keyframe = keyframes[i];
            const x1 = `${keyframe.computedOffset * 100}%`;
            if (i < keyframes.length - 1) {
                const x2 = `${keyframes[i + 1].computedOffset * 100}%`;
                drawLine(x1, x2);
            }
            const circle = drawCircle(x1);

            circle.addEventListener('click', (evt) => {
                //evt.target.classList.add('selected');
                showKeyframe(keyframe);
            });
        }
        parentElement.appendChild(elem);

        function drawCircle(x) {
            const circle = svg('circle');
            circle.classList.add('my-class');
            circle.setAttribute('cx', x);
            circle.setAttribute('cy', 10);
            circle.style.stroke = 'blue';
            circle.style.fill = 'blue';

            circle.setAttribute('r', 5);
            keyframesViewSVG.appendChild(circle);
            return circle;
        }

        function drawLine(x1, x2) {
            const line = svg('line');
            line.setAttribute('x1', x1);
            line.setAttribute('x2', x2);
            line.setAttribute('y1', 10);
            line.setAttribute('y2', 10);
            line.setAttribute('x1', x1);
            line.style.stroke = 'lightblue';
            line.style.strokeWidth = 2;

            keyframesViewSVG.appendChild(line);
            return line;
        }
    }

    function showKeyframe(keyframe) {
        keyframeView.innerHTML = `
        <tt>${keyframe.computedOffset * 100}% - ${keyframe.transform}</tt>`;
        console.log(keyframe);
    }
}

// Draws the timeline
function drawTimeline(animations, app) {
    const timeline = app.querySelector("#timeline");
    const play = app.querySelector("#play");

    requestAnimationFrame(updateTimeline);
    console.log(animations);

    timeline.addEventListener('input', function (evt) {
        const progress = evt.target.value;
        updateCurrentTime(parseInt(progress));
    });

    play.addEventListener('click', function (evt) {
        let animation = animations[0]; // Bit hacky
        updatePlayState(animation.playState == 'paused');
    });

    function updatePlayState(shouldPlay) {
        let animation = animations[0]; // Bit hacky
        if ((animation.playState != 'paused') == shouldPlay)
            return;
        if (shouldPlay) {
            for (let anim of animations)
                anim.play();
            play.value = "Pause";
            updateTimeline(document.timeline.currentTime);
        } else {
            for (let anim of animations)
                anim.pause();
            play.value = "Play â–¶";
        }
    }

    function updateTimeline(frameTime) {
        // Update timeline to current time
        let animation = animations[0]; // Bit hacky
        if (animation.playState == 'paused')
            return;
        const duration = animation.effect.getTiming().duration;
        timeline.value = (animation.currentTime % duration) * 100 / duration;
        requestAnimationFrame(updateTimeline);
    }

    // progress is between 0-100
    function updateCurrentTime(progress) {
        updatePlayState(false);
        for (let animation of animations) {
            // TODO: Use finite time length and allow extending animations.
            const duration = animation.effect.getTiming().duration;
            animation.currentTime = duration * progress / 100;
        }
    }
}

// Setup
// Animate content to have a running sample to work with

const sandbox = document.querySelector("#sandbox");
for (let box of sandbox.querySelectorAll(".box")) {
  box.animate(
      { transform : ['translateX(-100px)','translateX(100px)'] },
      {
          duration: 3000,
          iterations: Infinity // TODO: try infinity
      });
}

// Actual app code
const animations = document.getAnimations({subtree: true});
const app = document.querySelector("#app");

drawTimeline(animations, app);

function updateAnimations() {
  drawAnimations(animations, app);
}
updateAnimations();

// TODO: Move selection logic into its own component 
let selectedElement;
let targetedElement;
const EPSILON = 0.001;

function dragStart(evt) {
  evt.stopPropagation();
  // TODO: Get the animation from animations associated with evt.target
  let animation = evt.target.getAnimations()[0];
  // Get a keyframe for the current time
  // TODO: There is a bug here where currentTime can be larger than duration.
  let currentOffset = animation.currentTime / animation.effect.getTiming().duration;
  let keyframes = animation.effect.getKeyframes();
  let keyframe;
  let currentTransform = getComputedStyle(evt.target).transform;
  for (let index = 0; index < keyframes.length; index++) {
    // TODO: Find existing keyframe near currentOffset
    if (Math.abs(keyframes[index].computedOffset - currentOffset) < EPSILON) {
      keyframe = keyframes[index];
      break;
    } else if (keyframes[index].computedOffset > currentOffset) {
      // Insert new keyframe before index.
      keyframe = {
        offset: currentOffset,
      };
      keyframes.splice(index, 0, keyframe);
      break;
    }
  }

  let start = [evt.clientX, evt.clientY];
  console.log(evt);
  function dragMove(evt) {
    let delta = [evt.clientX - start[0], evt.clientY - start[1]];
    keyframe.transform = 'translate(' + delta[0] + 'px, ' + delta[1] + 'px) ' + currentTransform;
    animation.effect.setKeyframes(keyframes);
    updateAnimations();
  }

  function dragEnd(evt) {
    console.log(evt);
    evt.target.removeEventListener('pointermove', dragMove);
    evt.target.removeEventListener('pointercancel', dragEnd);
    evt.target.removeEventListener('pointerup', dragEnd);
    evt.target.releasePointerCapture(evt.pointerId);
  }
  evt.target.addEventListener('pointermove', dragMove);
  evt.target.addEventListener('pointercancel', dragEnd);
  evt.target.addEventListener('pointerup', dragEnd);
  evt.target.setPointerCapture(evt.pointerId);
}

function isAncestor(ancestor, node) {
  while (node && node != ancestor) {
    node = node.parentNode;
  }
  return node;
}

function selectElement(element) {
  if (targetedElement) {
    targetedElement.removeEventListener('pointerdown', dragStart);
    targetedElement.style.outline = '';
  }
  if (selectedElement) {
    if (!isAncestor(element, selectedElement))
      selectedElement = element;
  } else {
    selectedElement = element;
  }
  targetedElement = element;
  // Find the nearest ancestor with animations.
  // TODO: Allow creating animations on new nodes.
  while (targetedElement && targetedElement.getAnimations().length == 0)
    targetedElement = targetedElement.parentElement;
  if (targetedElement) {
    targetedElement.addEventListener('pointerdown', dragStart);
    targetedElement.style.outline = '1px solid blue';
  }
  let parents = $('#element-selector');
  // Remove all children
  parents.innerHTML = '';
  let cur = selectedElement;
  while (cur) {
    let elem = $('#element-item').cloneNode(true).content;
    elem.addEventListener('click', selectElement.bind(null, elem));
    $(elem, '.name').textContent = cur.tagName;
    if (cur == targetedElement) {
      $(elem, '.name').style.fontWeight = 'bold';
    }
    parents.appendChild(elem);
    cur = cur.parentElement;
  }
}

document.addEventListener('pointerdown', (evt) => {
  evt.stopPropagation();
  selectElement(evt.target);
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlcyI6WyJqcy91dGlscy5qcyIsImpzL2FuaW1hdGlvbnMuanMiLCJ0aW1lbGluZS5qcyIsImpzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlxuXG5leHBvcnQgZnVuY3Rpb24gJCgvKiBhcmdzICovKSB7XG4gICAgbGV0IHJvb3QgPSBkb2N1bWVudDtcbiAgICBsZXQgcXVlcnkgPSBhcmd1bWVudHNbMF07XG4gICAgaWYgKGFyZ3VtZW50c1swXSBpbnN0YW5jZW9mIEVsZW1lbnQgfHwgYXJndW1lbnRzWzBdIGluc3RhbmNlb2YgRG9jdW1lbnRGcmFnbWVudCkge1xuICAgICAgICByb290ID0gYXJndW1lbnRzWzBdO1xuICAgICAgICBxdWVyeSA9IGFyZ3VtZW50c1sxXTtcbiAgICB9XG4gICAgcmV0dXJuIHJvb3QucXVlcnlTZWxlY3RvcihxdWVyeSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzdmcodHlwZSkge1xuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgdHlwZSk7XG59IiwiLy8gVXRpbGl0eVxuaW1wb3J0IHsgJCwgc3ZnIH0gZnJvbSAnLi91dGlscy5qcycgXG5cbi8vIERyYXdzIHRoZSBhbmltYXRpb24gcGFuZWwgYXR0YWNoZWQgdG8gdGhlIGdpdmVuIGFwcCB2aWV3XG5leHBvcnQgZnVuY3Rpb24gZHJhd0FuaW1hdGlvbnMoYW5pbWF0aW9ucywgYXBwKSB7XG4gICAgY29uc3QgYW5pbWF0aW9uc1ZpZXcgPSBhcHAucXVlcnlTZWxlY3RvcihcIiNhbmltYXRpb25zXCIpO1xuICAgIGNvbnN0IGtleWZyYW1lVmlldyA9IGFwcC5xdWVyeVNlbGVjdG9yKFwiI2tleWZyYW1lXCIpO1xuXG4gICAgYW5pbWF0aW9uc1ZpZXcuaW5uZXJIVE1MID0gXCJcIjtcbiAgICBmb3IgKGxldCBhbmltYXRpb24gb2YgYW5pbWF0aW9ucykge1xuICAgICAgICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgICAgIGRyYXdBbmltYXRpb24obGksIGFuaW1hdGlvbik7XG4gICAgICAgIGFuaW1hdGlvbnNWaWV3LmFwcGVuZENoaWxkKGxpKTtcbiAgICB9XG5cbiAgICAvLyBEcmF3aW5nIGFuaW1hdGlvbiBrZXlmcmFtZXNcbiAgICBmdW5jdGlvbiBkcmF3QW5pbWF0aW9uKHBhcmVudEVsZW1lbnQsIGFuaW1hdGlvbikge1xuICAgICAgICAvLyBjb3B5IHRlbXBsYXRlIGZvciBmb28uXG4gICAgICAgIGxldCBlbGVtID0gJCgnI2FuaW1hdGlvbl90ZW1wbGF0ZScpLmNvbnRlbnQuY2xvbmVOb2RlKHRydWUpO1xuICAgICAgICAvLyAkKGVsZW0sJy50aW1pbmcnKS5pbm5lckhUTUw9YDxkaXYgY2xhc3M9XCJ0aW1pbmdzXCI+JHtKU09OLnN0cmluZ2lmeShhbmltYXRpb24uZWZmZWN0LmdldFRpbWluZygpKX08L2Rpdj5gXG4gICAgICAgIGNvbnN0IGtleWZyYW1lc1ZpZXdTVkcgPSAkKGVsZW0sICcua2V5ZnJhbWVzIHN2ZycpO1xuXG4gICAgICAgIGNvbnN0IGtleWZyYW1lcyA9IGFuaW1hdGlvbi5lZmZlY3QuZ2V0S2V5ZnJhbWVzKCk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5ZnJhbWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBrZXlmcmFtZSA9IGtleWZyYW1lc1tpXTtcbiAgICAgICAgICAgIGNvbnN0IHgxID0gYCR7a2V5ZnJhbWUuY29tcHV0ZWRPZmZzZXQgKiAxMDB9JWA7XG4gICAgICAgICAgICBpZiAoaSA8IGtleWZyYW1lcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgeDIgPSBgJHtrZXlmcmFtZXNbaSArIDFdLmNvbXB1dGVkT2Zmc2V0ICogMTAwfSVgXG4gICAgICAgICAgICAgICAgZHJhd0xpbmUoeDEsIHgyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGNpcmNsZSA9IGRyYXdDaXJjbGUoeDEpO1xuXG4gICAgICAgICAgICBjaXJjbGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZ0KSA9PiB7XG4gICAgICAgICAgICAgICAgLy9ldnQudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7XG4gICAgICAgICAgICAgICAgc2hvd0tleWZyYW1lKGtleWZyYW1lKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHBhcmVudEVsZW1lbnQuYXBwZW5kQ2hpbGQoZWxlbSk7XG5cbiAgICAgICAgZnVuY3Rpb24gZHJhd0NpcmNsZSh4KSB7XG4gICAgICAgICAgICBjb25zdCBjaXJjbGUgPSBzdmcoJ2NpcmNsZScpO1xuICAgICAgICAgICAgY2lyY2xlLmNsYXNzTGlzdC5hZGQoJ215LWNsYXNzJyk7XG4gICAgICAgICAgICBjaXJjbGUuc2V0QXR0cmlidXRlKCdjeCcsIHgpO1xuICAgICAgICAgICAgY2lyY2xlLnNldEF0dHJpYnV0ZSgnY3knLCAxMCk7XG4gICAgICAgICAgICBjaXJjbGUuc3R5bGUuc3Ryb2tlID0gJ2JsdWUnO1xuICAgICAgICAgICAgY2lyY2xlLnN0eWxlLmZpbGwgPSAnYmx1ZSc7XG5cbiAgICAgICAgICAgIGNpcmNsZS5zZXRBdHRyaWJ1dGUoJ3InLCA1KTtcbiAgICAgICAgICAgIGtleWZyYW1lc1ZpZXdTVkcuYXBwZW5kQ2hpbGQoY2lyY2xlKTtcbiAgICAgICAgICAgIHJldHVybiBjaXJjbGU7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBkcmF3TGluZSh4MSwgeDIpIHtcbiAgICAgICAgICAgIGNvbnN0IGxpbmUgPSBzdmcoJ2xpbmUnKTtcbiAgICAgICAgICAgIGxpbmUuc2V0QXR0cmlidXRlKCd4MScsIHgxKTtcbiAgICAgICAgICAgIGxpbmUuc2V0QXR0cmlidXRlKCd4MicsIHgyKTtcbiAgICAgICAgICAgIGxpbmUuc2V0QXR0cmlidXRlKCd5MScsIDEwKTtcbiAgICAgICAgICAgIGxpbmUuc2V0QXR0cmlidXRlKCd5MicsIDEwKTtcbiAgICAgICAgICAgIGxpbmUuc2V0QXR0cmlidXRlKCd4MScsIHgxKTtcbiAgICAgICAgICAgIGxpbmUuc3R5bGUuc3Ryb2tlID0gJ2xpZ2h0Ymx1ZSc7XG4gICAgICAgICAgICBsaW5lLnN0eWxlLnN0cm9rZVdpZHRoID0gMjtcblxuICAgICAgICAgICAga2V5ZnJhbWVzVmlld1NWRy5hcHBlbmRDaGlsZChsaW5lKTtcbiAgICAgICAgICAgIHJldHVybiBsaW5lO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2hvd0tleWZyYW1lKGtleWZyYW1lKSB7XG4gICAgICAgIGtleWZyYW1lVmlldy5pbm5lckhUTUwgPSBgXG4gICAgICAgIDx0dD4ke2tleWZyYW1lLmNvbXB1dGVkT2Zmc2V0ICogMTAwfSUgLSAke2tleWZyYW1lLnRyYW5zZm9ybX08L3R0PmA7XG4gICAgICAgIGNvbnNvbGUubG9nKGtleWZyYW1lKTtcbiAgICB9XG59XG4iLCIvLyBEcmF3cyB0aGUgdGltZWxpbmVcbmV4cG9ydCBmdW5jdGlvbiBkcmF3VGltZWxpbmUoYW5pbWF0aW9ucywgYXBwKSB7XG4gICAgY29uc3QgdGltZWxpbmUgPSBhcHAucXVlcnlTZWxlY3RvcihcIiN0aW1lbGluZVwiKTtcbiAgICBjb25zdCBwbGF5ID0gYXBwLnF1ZXJ5U2VsZWN0b3IoXCIjcGxheVwiKTtcblxuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSh1cGRhdGVUaW1lbGluZSk7XG4gICAgY29uc29sZS5sb2coYW5pbWF0aW9ucyk7XG5cbiAgICB0aW1lbGluZS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGZ1bmN0aW9uIChldnQpIHtcbiAgICAgICAgY29uc3QgcHJvZ3Jlc3MgPSBldnQudGFyZ2V0LnZhbHVlO1xuICAgICAgICB1cGRhdGVDdXJyZW50VGltZShwYXJzZUludChwcm9ncmVzcykpXG4gICAgfSk7XG5cbiAgICBwbGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2dCkge1xuICAgICAgICBsZXQgYW5pbWF0aW9uID0gYW5pbWF0aW9uc1swXTsgLy8gQml0IGhhY2t5XG4gICAgICAgIHVwZGF0ZVBsYXlTdGF0ZShhbmltYXRpb24ucGxheVN0YXRlID09ICdwYXVzZWQnKTtcbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIHVwZGF0ZVBsYXlTdGF0ZShzaG91bGRQbGF5KSB7XG4gICAgICAgIGxldCBhbmltYXRpb24gPSBhbmltYXRpb25zWzBdOyAvLyBCaXQgaGFja3lcbiAgICAgICAgaWYgKChhbmltYXRpb24ucGxheVN0YXRlICE9ICdwYXVzZWQnKSA9PSBzaG91bGRQbGF5KVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpZiAoc2hvdWxkUGxheSkge1xuICAgICAgICAgICAgZm9yIChsZXQgYW5pbSBvZiBhbmltYXRpb25zKVxuICAgICAgICAgICAgICAgIGFuaW0ucGxheSgpO1xuICAgICAgICAgICAgcGxheS52YWx1ZSA9IFwiUGF1c2VcIjtcbiAgICAgICAgICAgIHVwZGF0ZVRpbWVsaW5lKGRvY3VtZW50LnRpbWVsaW5lLmN1cnJlbnRUaW1lKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZvciAobGV0IGFuaW0gb2YgYW5pbWF0aW9ucylcbiAgICAgICAgICAgICAgICBhbmltLnBhdXNlKCk7XG4gICAgICAgICAgICBwbGF5LnZhbHVlID0gXCJQbGF5IOKWtlwiO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdXBkYXRlVGltZWxpbmUoZnJhbWVUaW1lKSB7XG4gICAgICAgIC8vIFVwZGF0ZSB0aW1lbGluZSB0byBjdXJyZW50IHRpbWVcbiAgICAgICAgbGV0IGFuaW1hdGlvbiA9IGFuaW1hdGlvbnNbMF07IC8vIEJpdCBoYWNreVxuICAgICAgICBpZiAoYW5pbWF0aW9uLnBsYXlTdGF0ZSA9PSAncGF1c2VkJylcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgY29uc3QgZHVyYXRpb24gPSBhbmltYXRpb24uZWZmZWN0LmdldFRpbWluZygpLmR1cmF0aW9uO1xuICAgICAgICB0aW1lbGluZS52YWx1ZSA9IChhbmltYXRpb24uY3VycmVudFRpbWUgJSBkdXJhdGlvbikgKiAxMDAgLyBkdXJhdGlvbjtcbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHVwZGF0ZVRpbWVsaW5lKTtcbiAgICB9XG5cbiAgICAvLyBwcm9ncmVzcyBpcyBiZXR3ZWVuIDAtMTAwXG4gICAgZnVuY3Rpb24gdXBkYXRlQ3VycmVudFRpbWUocHJvZ3Jlc3MpIHtcbiAgICAgICAgdXBkYXRlUGxheVN0YXRlKGZhbHNlKTtcbiAgICAgICAgZm9yIChsZXQgYW5pbWF0aW9uIG9mIGFuaW1hdGlvbnMpIHtcbiAgICAgICAgICAgIC8vIFRPRE86IFVzZSBmaW5pdGUgdGltZSBsZW5ndGggYW5kIGFsbG93IGV4dGVuZGluZyBhbmltYXRpb25zLlxuICAgICAgICAgICAgY29uc3QgZHVyYXRpb24gPSBhbmltYXRpb24uZWZmZWN0LmdldFRpbWluZygpLmR1cmF0aW9uO1xuICAgICAgICAgICAgYW5pbWF0aW9uLmN1cnJlbnRUaW1lID0gZHVyYXRpb24gKiBwcm9ncmVzcyAvIDEwMDtcbiAgICAgICAgfVxuICAgIH1cbn0iLCIndXNlIHN0cmljdCc7XG4vLyBpbXBvcnQgV2hhdGV2ZXIgZnJvbSAnaHR0cHM6Ly91bnBrZy5jb20vd2hhdGV2ZXInXG4vLyBpbXBvcnQgV2hhdGV2ZXIgZnJvbSAnd2hhdGV2ZXInXG4vLyBpbXBvcnQgeyBkZWZhdWx0IGFzIGluZGV4X2NzcyB9ICBmcm9tICcuL2Nzcy9pbmRleC5jc3MnXG5cbi8vIFV0aWxpdHlcbmltcG9ydCB7JCwgc3ZnfSBmcm9tICcuL3V0aWxzLmpzJ1xuXG4vLyBDb21wb25lbnRzXG5pbXBvcnQgeyBkcmF3QW5pbWF0aW9ucyB9IGZyb20gJy4vYW5pbWF0aW9ucy5qcydcbmltcG9ydCB7IGRyYXdUaW1lbGluZSB9IGZyb20gJy4uL3RpbWVsaW5lLmpzJztcblxuXG4vLyBTZXR1cFxuLy8gQW5pbWF0ZSBjb250ZW50IHRvIGhhdmUgYSBydW5uaW5nIHNhbXBsZSB0byB3b3JrIHdpdGhcblxuY29uc3Qgc2FuZGJveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjc2FuZGJveFwiKTtcbmZvciAobGV0IGJveCBvZiBzYW5kYm94LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYm94XCIpKSB7XG4gIGJveC5hbmltYXRlKFxuICAgICAgeyB0cmFuc2Zvcm0gOiBbJ3RyYW5zbGF0ZVgoLTEwMHB4KScsJ3RyYW5zbGF0ZVgoMTAwcHgpJ10gfSxcbiAgICAgIHtcbiAgICAgICAgICBkdXJhdGlvbjogMzAwMCxcbiAgICAgICAgICBpdGVyYXRpb25zOiBJbmZpbml0eSAvLyBUT0RPOiB0cnkgaW5maW5pdHlcbiAgICAgIH0pO1xufVxuXG4vLyBBY3R1YWwgYXBwIGNvZGVcbmNvbnN0IGFuaW1hdGlvbnMgPSBkb2N1bWVudC5nZXRBbmltYXRpb25zKHtzdWJ0cmVlOiB0cnVlfSk7XG5jb25zdCBhcHAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FwcFwiKTtcblxuZHJhd1RpbWVsaW5lKGFuaW1hdGlvbnMsIGFwcCk7XG5cbmZ1bmN0aW9uIHVwZGF0ZUFuaW1hdGlvbnMoKSB7XG4gIGRyYXdBbmltYXRpb25zKGFuaW1hdGlvbnMsIGFwcCk7XG59XG51cGRhdGVBbmltYXRpb25zKCk7XG5cbi8vIFRPRE86IE1vdmUgc2VsZWN0aW9uIGxvZ2ljIGludG8gaXRzIG93biBjb21wb25lbnQgXG5sZXQgc2VsZWN0ZWRFbGVtZW50O1xubGV0IHRhcmdldGVkRWxlbWVudDtcbmNvbnN0IEVQU0lMT04gPSAwLjAwMTtcblxuZnVuY3Rpb24gZHJhZ1N0YXJ0KGV2dCkge1xuICBldnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gIC8vIFRPRE86IEdldCB0aGUgYW5pbWF0aW9uIGZyb20gYW5pbWF0aW9ucyBhc3NvY2lhdGVkIHdpdGggZXZ0LnRhcmdldFxuICBsZXQgYW5pbWF0aW9uID0gZXZ0LnRhcmdldC5nZXRBbmltYXRpb25zKClbMF07XG4gIC8vIEdldCBhIGtleWZyYW1lIGZvciB0aGUgY3VycmVudCB0aW1lXG4gIC8vIFRPRE86IFRoZXJlIGlzIGEgYnVnIGhlcmUgd2hlcmUgY3VycmVudFRpbWUgY2FuIGJlIGxhcmdlciB0aGFuIGR1cmF0aW9uLlxuICBsZXQgY3VycmVudE9mZnNldCA9IGFuaW1hdGlvbi5jdXJyZW50VGltZSAvIGFuaW1hdGlvbi5lZmZlY3QuZ2V0VGltaW5nKCkuZHVyYXRpb247XG4gIGxldCBrZXlmcmFtZXMgPSBhbmltYXRpb24uZWZmZWN0LmdldEtleWZyYW1lcygpO1xuICBsZXQga2V5ZnJhbWU7XG4gIGxldCBjdXJyZW50VHJhbnNmb3JtID0gZ2V0Q29tcHV0ZWRTdHlsZShldnQudGFyZ2V0KS50cmFuc2Zvcm07XG4gIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBrZXlmcmFtZXMubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgLy8gVE9ETzogRmluZCBleGlzdGluZyBrZXlmcmFtZSBuZWFyIGN1cnJlbnRPZmZzZXRcbiAgICBpZiAoTWF0aC5hYnMoa2V5ZnJhbWVzW2luZGV4XS5jb21wdXRlZE9mZnNldCAtIGN1cnJlbnRPZmZzZXQpIDwgRVBTSUxPTikge1xuICAgICAga2V5ZnJhbWUgPSBrZXlmcmFtZXNbaW5kZXhdO1xuICAgICAgYnJlYWs7XG4gICAgfSBlbHNlIGlmIChrZXlmcmFtZXNbaW5kZXhdLmNvbXB1dGVkT2Zmc2V0ID4gY3VycmVudE9mZnNldCkge1xuICAgICAgLy8gSW5zZXJ0IG5ldyBrZXlmcmFtZSBiZWZvcmUgaW5kZXguXG4gICAgICBrZXlmcmFtZSA9IHtcbiAgICAgICAgb2Zmc2V0OiBjdXJyZW50T2Zmc2V0LFxuICAgICAgfTtcbiAgICAgIGtleWZyYW1lcy5zcGxpY2UoaW5kZXgsIDAsIGtleWZyYW1lKTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIGxldCBzdGFydCA9IFtldnQuY2xpZW50WCwgZXZ0LmNsaWVudFldO1xuICBjb25zb2xlLmxvZyhldnQpO1xuICBmdW5jdGlvbiBkcmFnTW92ZShldnQpIHtcbiAgICBsZXQgZGVsdGEgPSBbZXZ0LmNsaWVudFggLSBzdGFydFswXSwgZXZ0LmNsaWVudFkgLSBzdGFydFsxXV07XG4gICAga2V5ZnJhbWUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZSgnICsgZGVsdGFbMF0gKyAncHgsICcgKyBkZWx0YVsxXSArICdweCkgJyArIGN1cnJlbnRUcmFuc2Zvcm07XG4gICAgYW5pbWF0aW9uLmVmZmVjdC5zZXRLZXlmcmFtZXMoa2V5ZnJhbWVzKTtcbiAgICB1cGRhdGVBbmltYXRpb25zKCk7XG4gIH1cblxuICBmdW5jdGlvbiBkcmFnRW5kKGV2dCkge1xuICAgIGNvbnNvbGUubG9nKGV2dCk7XG4gICAgZXZ0LnRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKCdwb2ludGVybW92ZScsIGRyYWdNb3ZlKTtcbiAgICBldnQudGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJjYW5jZWwnLCBkcmFnRW5kKTtcbiAgICBldnQudGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJ1cCcsIGRyYWdFbmQpO1xuICAgIGV2dC50YXJnZXQucmVsZWFzZVBvaW50ZXJDYXB0dXJlKGV2dC5wb2ludGVySWQpO1xuICB9XG4gIGV2dC50YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcm1vdmUnLCBkcmFnTW92ZSk7XG4gIGV2dC50YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcmNhbmNlbCcsIGRyYWdFbmQpO1xuICBldnQudGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJ1cCcsIGRyYWdFbmQpO1xuICBldnQudGFyZ2V0LnNldFBvaW50ZXJDYXB0dXJlKGV2dC5wb2ludGVySWQpO1xufVxuXG5mdW5jdGlvbiBpc0FuY2VzdG9yKGFuY2VzdG9yLCBub2RlKSB7XG4gIHdoaWxlIChub2RlICYmIG5vZGUgIT0gYW5jZXN0b3IpIHtcbiAgICBub2RlID0gbm9kZS5wYXJlbnROb2RlO1xuICB9XG4gIHJldHVybiBub2RlO1xufVxuXG5mdW5jdGlvbiBzZWxlY3RFbGVtZW50KGVsZW1lbnQpIHtcbiAgaWYgKHRhcmdldGVkRWxlbWVudCkge1xuICAgIHRhcmdldGVkRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdwb2ludGVyZG93bicsIGRyYWdTdGFydCk7XG4gICAgdGFyZ2V0ZWRFbGVtZW50LnN0eWxlLm91dGxpbmUgPSAnJztcbiAgfVxuICBpZiAoc2VsZWN0ZWRFbGVtZW50KSB7XG4gICAgaWYgKCFpc0FuY2VzdG9yKGVsZW1lbnQsIHNlbGVjdGVkRWxlbWVudCkpXG4gICAgICBzZWxlY3RlZEVsZW1lbnQgPSBlbGVtZW50O1xuICB9IGVsc2Uge1xuICAgIHNlbGVjdGVkRWxlbWVudCA9IGVsZW1lbnQ7XG4gIH1cbiAgdGFyZ2V0ZWRFbGVtZW50ID0gZWxlbWVudDtcbiAgLy8gRmluZCB0aGUgbmVhcmVzdCBhbmNlc3RvciB3aXRoIGFuaW1hdGlvbnMuXG4gIC8vIFRPRE86IEFsbG93IGNyZWF0aW5nIGFuaW1hdGlvbnMgb24gbmV3IG5vZGVzLlxuICB3aGlsZSAodGFyZ2V0ZWRFbGVtZW50ICYmIHRhcmdldGVkRWxlbWVudC5nZXRBbmltYXRpb25zKCkubGVuZ3RoID09IDApXG4gICAgdGFyZ2V0ZWRFbGVtZW50ID0gdGFyZ2V0ZWRFbGVtZW50LnBhcmVudEVsZW1lbnQ7XG4gIGlmICh0YXJnZXRlZEVsZW1lbnQpIHtcbiAgICB0YXJnZXRlZEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcmRvd24nLCBkcmFnU3RhcnQpO1xuICAgIHRhcmdldGVkRWxlbWVudC5zdHlsZS5vdXRsaW5lID0gJzFweCBzb2xpZCBibHVlJztcbiAgfVxuICBsZXQgcGFyZW50cyA9ICQoJyNlbGVtZW50LXNlbGVjdG9yJyk7XG4gIC8vIFJlbW92ZSBhbGwgY2hpbGRyZW5cbiAgcGFyZW50cy5pbm5lckhUTUwgPSAnJztcbiAgbGV0IGN1ciA9IHNlbGVjdGVkRWxlbWVudDtcbiAgd2hpbGUgKGN1cikge1xuICAgIGxldCBlbGVtID0gJCgnI2VsZW1lbnQtaXRlbScpLmNsb25lTm9kZSh0cnVlKS5jb250ZW50O1xuICAgIGVsZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzZWxlY3RFbGVtZW50LmJpbmQobnVsbCwgZWxlbSkpO1xuICAgICQoZWxlbSwgJy5uYW1lJykudGV4dENvbnRlbnQgPSBjdXIudGFnTmFtZTtcbiAgICBpZiAoY3VyID09IHRhcmdldGVkRWxlbWVudCkge1xuICAgICAgJChlbGVtLCAnLm5hbWUnKS5zdHlsZS5mb250V2VpZ2h0ID0gJ2JvbGQnO1xuICAgIH1cbiAgICBwYXJlbnRzLmFwcGVuZENoaWxkKGVsZW0pO1xuICAgIGN1ciA9IGN1ci5wYXJlbnRFbGVtZW50O1xuICB9XG59XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJkb3duJywgKGV2dCkgPT4ge1xuICBldnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gIHNlbGVjdEVsZW1lbnQoZXZ0LnRhcmdldCk7XG59KTtcblxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVPLFNBQVMsQ0FBQyxhQUFhO0FBQzlCLElBQUksSUFBSSxJQUFJLEdBQUcsUUFBUSxDQUFDO0FBQ3hCLElBQUksSUFBSSxLQUFLLEdBQUcsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQzdCLElBQUksSUFBSSxTQUFTLENBQUMsQ0FBQyxDQUFDLFlBQVksT0FBTyxJQUFJLFNBQVMsQ0FBQyxDQUFDLENBQUMsWUFBWSxnQkFBZ0IsRUFBRTtBQUNyRixRQUFRLElBQUksR0FBRyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDNUIsUUFBUSxLQUFLLEdBQUcsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQzdCLEtBQUs7QUFDTCxJQUFJLE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUNyQyxDQUFDO0FBQ0Q7QUFDTyxTQUFT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
