// import Whatever from 'https://unpkg.com/whatever'
// import Whatever from 'whatever'

// import { default as index_css }  from './css/index.css'

// import {h, render } from 'https://unpkg.com/preact?module';
// import {App} from './app.js'

// // console.info(index_css)
// console.log('ðŸ’€ðŸ¤˜')
// render(h(App), document.getElementById("app"));

// Setup
// Animate content to have a running sample to work with
const sandbox = document.querySelector("#sandbox");
for (let box of sandbox.querySelectorAll(".box")) {
  box.animate(
      { transform : ['translateX(-100px)', 'translateX(100px)'] },
      {
          duration: 3000, direction: "alternate",
          iterations: Infinity // TODO: try infinity
      });
}
let animations;



function dragStart(evt) {
  // TODO: Get the animation from animations associated with evt.target
  let animation = animations[0];
  // Get a keyframe for the current time
  let currentOffset = animation.currentTime / animation.effect.getTiming().duration;
  let keyframes = animation.effect.getKeyframes();
  let keyframe;
  let currentTransform = getComputedStyle(evt.target).transform;
  for (let index = 0; index < keyframes.length; index++) {
    // TODO: Find existing keyframe near currentOffset
    if (keyframes[index].computedOffset > currentOffset) {
      // Insert new keyframe before index.
      keyframe = {
        offset: currentOffset,
      };
      keyframes.splice(index, 0, keyframe);
      break;
    }
  }

  let start = [evt.clientX, evt.clientY];
  console.log(evt);
  function dragMove(evt) {
    let delta = [evt.clientX - start[0], evt.clientY - start[1]];
    keyframe.transform = 'translate(' + delta[0] + 'px, ' + delta[1] + 'px) ' + currentTransform;
    animation.effect.setKeyframes(keyframes);
  }

  function dragEnd(evt) {
    console.log(evt);
    evt.target.removeEventListener('pointermove', dragMove);
    evt.target.removeEventListener('pointercancel', dragEnd);
    evt.target.removeEventListener('pointerup', dragEnd);
    evt.target.releasePointerCapture(evt.pointerId);
  }
  evt.target.addEventListener('pointermove', dragMove);
  evt.target.addEventListener('pointercancel', dragEnd);
  evt.target.addEventListener('pointerup', dragEnd);
  evt.target.setPointerCapture(evt.pointerId);
}

function selectElement(element) {
    // TODO: should we grab the subtree animations as well?
    animations = element.getAnimations();
    element.addEventListener('pointerdown', dragStart);
}

const app = document.querySelector("#app");
const timeline = app.querySelector("#timeline");

timeline.addEventListener('input', function(evt) {
    const progress = evt.target.value;
    updateCurrentTime(parseInt(progress));
});

selectElement(sandbox.querySelector(".box"));
console.log(animations);

// progress is between 0-100
function updateCurrentTime(progress) {
    for (let animation of animations) {
        animation.pause();
        // TODO: Use finite time length and allow extending animations.
        const duration = animation.effect.getTiming().duration;
        animation.currentTime = duration * progress/100;
    }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlcyI6WyJqcy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG4vLyBpbXBvcnQgV2hhdGV2ZXIgZnJvbSAnaHR0cHM6Ly91bnBrZy5jb20vd2hhdGV2ZXInXG4vLyBpbXBvcnQgV2hhdGV2ZXIgZnJvbSAnd2hhdGV2ZXInXG5cbi8vIGltcG9ydCB7IGRlZmF1bHQgYXMgaW5kZXhfY3NzIH0gIGZyb20gJy4vY3NzL2luZGV4LmNzcydcblxuLy8gaW1wb3J0IHtoLCByZW5kZXIgfSBmcm9tICdodHRwczovL3VucGtnLmNvbS9wcmVhY3Q/bW9kdWxlJztcbi8vIGltcG9ydCB7QXBwfSBmcm9tICcuL2FwcC5qcydcblxuLy8gLy8gY29uc29sZS5pbmZvKGluZGV4X2Nzcylcbi8vIGNvbnNvbGUubG9nKCfwn5KA8J+kmCcpXG4vLyByZW5kZXIoaChBcHApLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFwcFwiKSk7XG5cbi8vIFNldHVwXG4vLyBBbmltYXRlIGNvbnRlbnQgdG8gaGF2ZSBhIHJ1bm5pbmcgc2FtcGxlIHRvIHdvcmsgd2l0aFxuY29uc3Qgc2FuZGJveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjc2FuZGJveFwiKTtcbmZvciAobGV0IGJveCBvZiBzYW5kYm94LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYm94XCIpKSB7XG4gIGJveC5hbmltYXRlKFxuICAgICAgeyB0cmFuc2Zvcm0gOiBbJ3RyYW5zbGF0ZVgoLTEwMHB4KScsICd0cmFuc2xhdGVYKDEwMHB4KSddIH0sXG4gICAgICB7XG4gICAgICAgICAgZHVyYXRpb246IDMwMDAsIGRpcmVjdGlvbjogXCJhbHRlcm5hdGVcIixcbiAgICAgICAgICBpdGVyYXRpb25zOiBJbmZpbml0eSAvLyBUT0RPOiB0cnkgaW5maW5pdHlcbiAgICAgIH0pO1xufVxuXG4vLyBBY3R1YWwgYXBwIGNvZGVcbmxldCBzZWxlY3RlZEVsZW1lbnQ7XG5sZXQgYW5pbWF0aW9ucztcblxuXG5cbmZ1bmN0aW9uIGRyYWdTdGFydChldnQpIHtcbiAgLy8gVE9ETzogR2V0IHRoZSBhbmltYXRpb24gZnJvbSBhbmltYXRpb25zIGFzc29jaWF0ZWQgd2l0aCBldnQudGFyZ2V0XG4gIGxldCBhbmltYXRpb24gPSBhbmltYXRpb25zWzBdO1xuICAvLyBHZXQgYSBrZXlmcmFtZSBmb3IgdGhlIGN1cnJlbnQgdGltZVxuICBsZXQgY3VycmVudE9mZnNldCA9IGFuaW1hdGlvbi5jdXJyZW50VGltZSAvIGFuaW1hdGlvbi5lZmZlY3QuZ2V0VGltaW5nKCkuZHVyYXRpb247XG4gIGxldCBrZXlmcmFtZXMgPSBhbmltYXRpb24uZWZmZWN0LmdldEtleWZyYW1lcygpO1xuICBsZXQga2V5ZnJhbWU7XG4gIGxldCBjdXJyZW50VHJhbnNmb3JtID0gZ2V0Q29tcHV0ZWRTdHlsZShldnQudGFyZ2V0KS50cmFuc2Zvcm07XG4gIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBrZXlmcmFtZXMubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgLy8gVE9ETzogRmluZCBleGlzdGluZyBrZXlmcmFtZSBuZWFyIGN1cnJlbnRPZmZzZXRcbiAgICBpZiAoa2V5ZnJhbWVzW2luZGV4XS5jb21wdXRlZE9mZnNldCA+IGN1cnJlbnRPZmZzZXQpIHtcbiAgICAgIC8vIEluc2VydCBuZXcga2V5ZnJhbWUgYmVmb3JlIGluZGV4LlxuICAgICAga2V5ZnJhbWUgPSB7XG4gICAgICAgIG9mZnNldDogY3VycmVudE9mZnNldCxcbiAgICAgIH07XG4gICAgICBrZXlmcmFtZXMuc3BsaWNlKGluZGV4LCAwLCBrZXlmcmFtZSk7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICBsZXQgc3RhcnQgPSBbZXZ0LmNsaWVudFgsIGV2dC5jbGllbnRZXTtcbiAgY29uc29sZS5sb2coZXZ0KTtcbiAgZnVuY3Rpb24gZHJhZ01vdmUoZXZ0KSB7XG4gICAgbGV0IGRlbHRhID0gW2V2dC5jbGllbnRYIC0gc3RhcnRbMF0sIGV2dC5jbGllbnRZIC0gc3RhcnRbMV1dO1xuICAgIGtleWZyYW1lLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGUoJyArIGRlbHRhWzBdICsgJ3B4LCAnICsgZGVsdGFbMV0gKyAncHgpICcgKyBjdXJyZW50VHJhbnNmb3JtO1xuICAgIGFuaW1hdGlvbi5lZmZlY3Quc2V0S2V5ZnJhbWVzKGtleWZyYW1lcyk7XG4gIH1cblxuICBmdW5jdGlvbiBkcmFnRW5kKGV2dCkge1xuICAgIGNvbnNvbGUubG9nKGV2dCk7XG4gICAgZXZ0LnRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKCdwb2ludGVybW92ZScsIGRyYWdNb3ZlKTtcbiAgICBldnQudGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJjYW5jZWwnLCBkcmFnRW5kKTtcbiAgICBldnQudGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJ1cCcsIGRyYWdFbmQpO1xuICAgIGV2dC50YXJnZXQucmVsZWFzZVBvaW50ZXJDYXB0dXJlKGV2dC5wb2ludGVySWQpO1xuICB9XG4gIGV2dC50YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcm1vdmUnLCBkcmFnTW92ZSk7XG4gIGV2dC50YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcmNhbmNlbCcsIGRyYWdFbmQpO1xuICBldnQudGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJ1cCcsIGRyYWdFbmQpO1xuICBldnQudGFyZ2V0LnNldFBvaW50ZXJDYXB0dXJlKGV2dC5wb2ludGVySWQpO1xufVxuXG5mdW5jdGlvbiBzZWxlY3RFbGVtZW50KGVsZW1lbnQpIHtcbiAgICBzZWxlY3RlZEVsZW1lbnQgPSBlbGVtZW50O1xuICAgIC8vIFRPRE86IHNob3VsZCB3ZSBncmFiIHRoZSBzdWJ0cmVlIGFuaW1hdGlvbnMgYXMgd2VsbD9cbiAgICBhbmltYXRpb25zID0gZWxlbWVudC5nZXRBbmltYXRpb25zKCk7XG4gICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVyZG93bicsIGRyYWdTdGFydCk7XG59XG5cbmNvbnN0IGFwcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXBwXCIpO1xuY29uc3QgdGltZWxpbmUgPSBhcHAucXVlcnlTZWxlY3RvcihcIiN0aW1lbGluZVwiKTtcblxudGltZWxpbmUuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBmdW5jdGlvbihldnQpIHtcbiAgICBjb25zdCBwcm9ncmVzcyA9IGV2dC50YXJnZXQudmFsdWU7XG4gICAgdXBkYXRlQ3VycmVudFRpbWUocGFyc2VJbnQocHJvZ3Jlc3MpKVxufSk7XG5cbnNlbGVjdEVsZW1lbnQoc2FuZGJveC5xdWVyeVNlbGVjdG9yKFwiLmJveFwiKSlcbmNvbnNvbGUubG9nKGFuaW1hdGlvbnMpO1xuXG4vLyBwcm9ncmVzcyBpcyBiZXR3ZWVuIDAtMTAwXG5mdW5jdGlvbiB1cGRhdGVDdXJyZW50VGltZShwcm9ncmVzcykge1xuICAgIGZvciAobGV0IGFuaW1hdGlvbiBvZiBhbmltYXRpb25zKSB7XG4gICAgICAgIGFuaW1hdGlvbi5wYXVzZSgpO1xuICAgICAgICAvLyBUT0RPOiBVc2UgZmluaXRlIHRpbWUgbGVuZ3RoIGFuZCBhbGxvdyBleHRlbmRpbmcgYW5pbWF0aW9ucy5cbiAgICAgICAgY29uc3QgZHVyYXRpb24gPSBhbmltYXRpb24uZWZmZWN0LmdldFRpbWluZygpLmR1cmF0aW9uO1xuICAgICAgICBhbmltYXRpb24uY3VycmVudFRpbWUgPSBkdXJhdGlvbiAqIHByb2dyZXNzLzEwMDtcbiAgICB9XG59XG5cblxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNLE9BQU8sR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0FBQ25ELEtBQUssSUFBSSxHQUFHLElBQUksT0FBTyxDQUFDLGdCQUFnQixDQUFDLE1B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
